<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>発注書作成システム - 株式会社諸鹿彩色</title>
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>📋</text></svg>">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="styles.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js" defer></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js" defer></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js" defer></script>
</head>
<body>
    <div class="app-shell">
        <header class="page-header">
            <div class="header-badge">MOROGA ORDER SYSTEM</div>
            <h1>発注書作成システム</h1>
            <p>入力した内容をそのままのレイアウトで PDF に変換できます。<br>必要事項を入力後、プレビューボタンから内容をご確認ください。</p>
        </header>

        <main class="page-main">
            <section class="form-panel">
                <form id="orderForm" class="order-form" autocomplete="off">
                    <section class="form-section">
                        <h2>発注元情報</h2>
                        <div class="form-grid">
                            <div class="form-group">
                                <label for="companyName">会社名</label>
                                <input type="text" id="companyName" name="companyName" value="株式会社諸鹿彩色">
                            </div>
                            <div class="form-group">
                                <label for="companyCode">登録番号 (Invoice)</label>
                                <input type="text" id="companyCode" name="companyCode" value="T6060001025935">
                            </div>
                            <div class="form-group">
                                <label for="companyAddress">住所</label>
                                <input type="text" id="companyAddress" name="companyAddress" value="〒321-0111 栃木県宇都宮市川田町1048-5">
                            </div>
                            <div class="form-group">
                                <label for="companyPhone">TEL / FAX</label>
                                <input type="text" id="companyPhone" name="companyPhone" value="TEL: 028-688-8618　FAX: 028-688-0668">
                            </div>
                            <div class="form-group">
                                <label for="companyEmail">Email</label>
                                <input type="email" id="companyEmail" name="companyEmail" value="info@moroga.info">
                            </div>
                            <div class="form-group">
                                <label for="orderNumber">発注書番号</label>
                                <input type="text" id="orderNumber" name="orderNumber" placeholder="自動採番">
                            </div>
                        </div>
                    </section>

                    <section class="form-section">
                        <h2>発注先情報</h2>
                        <div class="form-grid">
                            <div class="form-group">
                                <label for="supplierName">発注先会社名</label>
                                <input type="text" id="supplierName" name="supplierName" placeholder="株式会社〇〇商会">
                            </div>
                            <div class="form-group">
                                <label for="supplierAddress">発注先住所</label>
                                <input type="text" id="supplierAddress" name="supplierAddress" placeholder="〒000-0000 東京都〇〇区〇〇 0-0-0">
                            </div>
                            <div class="form-group">
                                <label for="contactPerson">担当者名</label>
                                <input type="text" id="contactPerson" name="contactPerson" placeholder="担当者名">
                            </div>
                            <div class="form-group">
                                <label for="deliveryLocation">納入場所</label>
                                <input type="text" id="deliveryLocation" name="deliveryLocation" placeholder="納品先や工事現場など">
                            </div>
                        </div>
                    </section>

                    <section class="form-section">
                        <h2>スケジュール / 担当</h2>
                        <div class="form-grid">
                            <div class="form-group">
                                <label for="orderDate">発注日</label>
                                <input type="date" id="orderDate" name="orderDate">
                            </div>
                            <div class="form-group">
                                <label for="completionMonth">工事完了予定</label>
                                <input type="month" id="completionMonth" name="completionMonth">
                            </div>
                            <div class="form-group">
                                <label for="deliveryDate">納期</label>
                                <input type="date" id="deliveryDate" name="deliveryDate">
                            </div>
                            <div class="form-group">
                                <label for="paymentDueDate">支払期日</label>
                                <input type="date" id="paymentDueDate" name="paymentDueDate">
                            </div>
                            <div class="form-group">
                                <label for="paymentTerms">支払条件</label>
                                <select id="paymentTerms" name="paymentTerms">
                                    <option value="工事完了月の翌月末払い">工事完了月の翌月末払い</option>
                                    <option value="工事完了の翌々月末払い">工事完了の翌々月末払い</option>
                                    <option value="工事完了の翌月払い">工事完了の翌月払い</option>
                                    <option value="現金">現金</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="staffMember">担当</label>
                                <select id="staffMember" name="staffMember">
                                    <option value="">担当を選択してください</option>
                                    <option value="諸鹿大介">諸鹿大介</option>
                                    <option value="奥山竜矢">奥山竜矢</option>
                                </select>
                            </div>
                        </div>
                    </section>

                    <section class="form-section">
                        <div class="section-headline">
                            <h2>商品情報</h2>
                            <button type="button" id="addItemBtn" class="btn btn-secondary btn-icon">
                                <span>＋</span>行を追加
                            </button>
                        </div>
                        <div id="itemsContainer" class="items-container"></div>
                        <div class="items-summary">
                            <div class="summary-card">
                                <dt>商品小計</dt>
                                <dd>¥<span id="itemsTotal">0</span></dd>
                            </div>
                            <div class="summary-card">
                                <dt>現在の行数</dt>
                                <dd><span id="itemsCount">0</span> 行</dd>
                            </div>
                        </div>
                    </section>

                    <section class="form-section">
                        <h2>その他</h2>
                        <div class="form-grid">
                            <div class="form-group">
                                <label for="taxRate">消費税率</label>
                                <select id="taxRate" name="taxRate">
                                    <option value="0.1">10%（標準）</option>
                                    <option value="0.08">8%（軽減）</option>
                                    <option value="0">非課税</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="bankDetails">振込先 / 支払先</label>
                                <textarea id="bankDetails" name="bankDetails" rows="3" placeholder="〇〇銀行 〇〇支店 普通 0000000 株式会社諸鹿彩色"></textarea>
                            </div>
                            <div class="form-group full-width">
                                <label for="notes">備考</label>
                                <textarea id="notes" name="notes" rows="4" placeholder="特記事項や伝達事項があれば入力してください"></textarea>
                            </div>
                        </div>
                    </section>

                    <section class="totals-panel">
                        <div class="totals-line"><span>小計</span><strong>¥<span id="subtotal">0</span></strong></div>
                        <div class="totals-line"><span>消費税</span><strong>¥<span id="tax">0</span></strong></div>
                        <div class="totals-line grand-total"><span>合計金額</span><strong>¥<span id="total">0</span></strong></div>
                    </section>

                    <div class="button-row">
                        <button type="button" id="previewBtn" class="btn btn-primary">プレビュー</button>
                        <button type="button" id="resetBtn" class="btn btn-outline">リセット</button>
                    </div>
                </form>
            </section>
        </main>
    </div>

    <div id="previewModal" class="modal" aria-hidden="true" role="dialog" aria-labelledby="previewModalTitle">
        <div class="modal-dialog" role="document">
            <div class="modal-header">
                <h2 id="previewModalTitle">発注書プレビュー</h2>
                <button type="button" class="modal-close" aria-label="閉じる">×</button>
            </div>
            <div class="modal-body">
                <div id="previewContent"></div>
            </div>
            <div class="modal-footer">
                <button id="downloadPdfBtn" class="btn btn-primary">PDFをダウンロード</button>
                <button id="printBtn" class="btn btn-secondary">印刷</button>
                <button id="closePreviewBtn" class="btn btn-outline">閉じる</button>
            </div>
        </div>
    </div>

    <script src="script.js" defer></script>
</body>
</html>
